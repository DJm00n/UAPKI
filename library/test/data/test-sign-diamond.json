{
  "comment": "Generate PKCS7/CAdES-signature use DIAMOND",
  "comment2": "Для коректного відображення utf8 тексту под ОС Windows",
  "comment3": "треба перед запуском теста в терміналі ввести 'chcp 65001'",
  "comment4": "або ввімкнути підтримку utf8 в терміналі для всієї ОС Windows 10",
  "comment5": "Updated 2021-09-06",
  //"locale": "", // Локаль за замовчуванням
  //"locale": "C", // Мінімальна C-локаль
  //"locale": "Ukrainian_Ukraine.utf8",
  "tasks": [
    {
      "method": "VERSION"
    },
    {
      "comment": "Ініціалізація бібліотеки",
      "method": "INIT",
      "parameters": {
        "cmProviders": {
          "dir": "", // full path
          "allowedProviders": [
            {
              "lib": "cm-diamond"
            }
          ]
        },
        "certCache": {
          "path": "certs/", // full path
          "trustedCerts": []
        },
        "crlCache": {
          "path": "certs/crls/" // full path
        },
        "offline": false,
        "tsp": {
          "url": "http://acskidd.gov.ua/services/tsp/"
        }
      }
    },
    {
      "comment": "Отримання переліку провайдерів підпису (типів носіів ключів: файли, токени, смарт-картки, хмарні криптомодулі та ін.)",
      "method": "PROVIDERS",
      "skip": false
    },
    {
      "comment": "Отримання переліку носіїв ключів для заданого провайдера та їх властивостей",
      "method": "STORAGES",
      "parameters": {
        "provider": "DIAMOND" // Обов'язкове (ідентифікатор провайдера зі списку що повертає метод PROVIDERS)
      }
    },
    {
      "comment": "Відкриття носія ключів",
      "method": "OPEN",
      "parameters": {
        "provider": "DIAMOND",
        "storage": "2000019",
        "username": "0", // DIAMOND-provider ідентифікатор користувача, обов'язковий.
        "password": "12345677",
        "mode": "RO"
      }
    },
    {
      "comment": "Отримання переліку ключів на носії",
      "method": "KEYS"
    },
    {
      "comment": "Обрання ключа з переліку ключів на носії (та отримання його сертифікату)",
      "method": "SELECT_KEY",
      "parameters": {
        "id": "CEF1C39D4E1EF68D8578319AE16D0C6B9F322375" // Обов'язковий, ідентифікатор ключа
        //"id": "D02F36247D7D303FE2FC0CE3F5AAFD62EE2588451711B8FED5B10BB5E35324C9"
      }
    },
    {
      "comment": "формування підпису. Параметри наступні: CMS, attached data",
      "method": "SIGN",
      "parameters": {
        "signParams": {
          "signatureFormat": "CMS", // Обов'язковий. Підтримує формати CAdES-BES/CAdES-T/CMS/RAW. Для CAdES-C, CAdES-Av3 додатково треба використовувати метод EXTEND_SIGN
          //"signAlgo": "1.2.804.2.1.1.1.1.3.1.1", // Опціональний, якщо не вказаний, то використовується перший алгоритм підпису із списку signAlgo для ключа
          "detachedData": false, // Опціональний, по замовчанню true (дані не інкапсулюються)
          "includeCert": false, // Опціональний, по замовчанню false (додати до підпису сертифікат)
          "includeTime": true // Опціональний, по замовчанню false (додати до підпису час хосту (не довірений))
          //"includeContentTS": true // Опціональний, по замовчанню false (додати до підпису TSP від даних)
        },
        "dataTbs": [
          {
            "id": "doc-0", // Обов'язковий, ідентифікатор даних
            "bytes": "QWxpY2UgYW5kIEJvYgpodHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9BbGljZV9hbmRfQm9i", // обов'язковий, дані для підпису у кодировці base64
            "signedAttributes": [
              {
                "type": "1.2.3.4",
                "bytes": "AgEB"
              }
            ]

          }
        ]
      },
      "skip": false
    },
    {
      "method": "CLOSE"
    },
    {
      "method": "DEINIT"
    }
  ]
}